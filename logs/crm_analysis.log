2025-09-30 12:09:25 | INFO     | __main__:main:113 | ================================================================================
2025-09-30 12:09:25 | INFO     | __main__:main:114 | CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:09:25 | INFO     | __main__:main:115 | ================================================================================
2025-09-30 12:09:25 | INFO     | __main__:main:116 | Environment: development
2025-09-30 12:09:25 | INFO     | __main__:main:117 | Python Version: 3.9.6 (default, Nov 11 2024, 03:15:38) 
[Clang 16.0.0 (clang-1600.0.26.6)]
2025-09-30 12:09:25 | INFO     | __main__:main:118 | Project Root: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project
2025-09-30 12:09:25 | INFO     | __main__:main:119 | Start Time: 2025-09-30 12:09:25.694200
2025-09-30 12:09:25 | INFO     | __main__:main:120 | ================================================================================
2025-09-30 12:09:25 | INFO     | src.pipeline.orchestrator:__init__:76 | Pipeline Orchestrator initialized
2025-09-30 12:09:25 | INFO     | src.utils.decorators:wrapper:55 | Starting run_pipeline...
2025-09-30 12:09:25 | INFO     | src.pipeline.orchestrator:run_pipeline:119 | ================================================================================
2025-09-30 12:09:25 | INFO     | src.pipeline.orchestrator:run_pipeline:120 | STARTING INDUSTRIAL CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:09:25 | INFO     | src.pipeline.orchestrator:run_pipeline:121 | ================================================================================
2025-09-30 12:09:25 | INFO     | src.pipeline.orchestrator:run_pipeline:122 | Start time: 2025-09-30 12:09:25.695055
2025-09-30 12:09:25 | INFO     | src.pipeline.orchestrator:run_pipeline:123 | Environment: development
2025-09-30 12:09:25 | INFO     | src.pipeline.orchestrator:run_pipeline:124 | Configuration loaded from: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/config
2025-09-30 12:09:25 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:09:25 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_COLLECTION
2025-09-30 12:09:25 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:09:25 | INFO     | src.utils.decorators:wrapper:55 | Starting collect_all_data...
2025-09-30 12:09:25 | INFO     | src.data.collector:collect_all_data:48 | Collecting data from sources: ['customers', 'transactions', 'interactions', 'marketing']
2025-09-30 12:09:25 | INFO     | src.data.collector:collect_all_data:49 | Date range: 2023-10-01 to 2025-09-30
2025-09-30 12:09:25 | INFO     | src.utils.database:redis_client:224 | Connected to Redis cache
2025-09-30 12:09:25 | WARNING  | src.utils.database:get_cached_dataframe:260 | Failed to retrieve cached DataFrame: Error 61 connecting to localhost:6379. Connection refused.
2025-09-30 12:09:25 | WARNING  | src.utils.database:get_cached_dataframe:260 | Failed to retrieve cached DataFrame: Error 61 connecting to localhost:6379. Connection refused.
2025-09-30 12:09:25 | WARNING  | src.utils.database:get_cached_dataframe:260 | Failed to retrieve cached DataFrame: Error 61 connecting to localhost:6379. Connection refused.
2025-09-30 12:09:25 | WARNING  | src.utils.database:get_cached_dataframe:260 | Failed to retrieve cached DataFrame: Error 61 connecting to localhost:6379. Connection refused.
2025-09-30 12:09:25 | INFO     | src.utils.database:engine:84 | Created database engine for localhost:5432/crm_analytics
2025-09-30 12:09:25 | INFO     | src.utils.database:engine:84 | Created database engine for localhost:5432/crm_analytics
2025-09-30 12:09:25 | INFO     | src.utils.database:engine:84 | Created database engine for localhost:5432/crm_analytics
2025-09-30 12:09:26 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:09:26 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:09:26 | WARNING  | src.data.collector:_collect_customers:143 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:09:26 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:09:26 | WARNING  | src.data.collector:_collect_transactions:184 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:09:26 | WARNING  | src.data.collector:_collect_interactions:220 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:09:26 | WARNING  | src.utils.decorators:wrapper:153 | _collect_transactions failed (attempt 1/3). Retrying in 4.0 seconds...
2025-09-30 12:09:26 | WARNING  | src.utils.decorators:wrapper:153 | _collect_interactions failed (attempt 1/3). Retrying in 4.0 seconds...
2025-09-30 12:09:26 | INFO     | src.data.collector:_simulate_customers:299 | Simulated 50000 customer records
2025-09-30 12:09:30 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:09:30 | WARNING  | src.data.collector:_collect_interactions:220 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:09:30 | WARNING  | src.utils.decorators:wrapper:153 | _collect_interactions failed (attempt 2/3). Retrying in 8.0 seconds...
2025-09-30 12:09:30 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:09:30 | WARNING  | src.data.collector:_collect_transactions:184 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:09:30 | WARNING  | src.utils.decorators:wrapper:153 | _collect_transactions failed (attempt 2/3). Retrying in 8.0 seconds...
2025-09-30 12:09:38 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:09:38 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:09:38 | WARNING  | src.data.collector:_collect_interactions:220 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:09:38 | ERROR    | src.utils.decorators:wrapper:149 | _collect_interactions failed after 3 attempts
2025-09-30 12:09:38 | WARNING  | src.data.collector:_collect_transactions:184 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:09:38 | ERROR    | src.utils.decorators:wrapper:149 | _collect_transactions failed after 3 attempts
2025-09-30 12:09:38 | ERROR    | src.utils.decorators:wrapper:118 | Error in collect_all_data: 'DataCollector' object has no attribute '_collect_marketing'
2025-09-30 12:09:38 | ERROR    | src.utils.decorators:wrapper:68 | collect_all_data failed after 12.42 seconds: 'DataCollector' object has no attribute '_collect_marketing'
2025-09-30 12:09:38 | ERROR    | src.pipeline.orchestrator:run_pipeline:178 | ✗ Stage data_collection failed: 'DataCollector' object has no attribute '_collect_marketing'
2025-09-30 12:09:38 | INFO     | src.pipeline.orchestrator:_generate_pipeline_report:608 | Pipeline report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/pipeline_report.json
2025-09-30 12:09:38 | INFO     | src.utils.database:close_connections:279 | All database connections closed
2025-09-30 12:09:38 | DEBUG    | src.pipeline.orchestrator:_cleanup:645 | Resources cleaned up
2025-09-30 12:09:38 | INFO     | src.pipeline.orchestrator:run_pipeline:206 | ================================================================================
2025-09-30 12:09:38 | INFO     | src.pipeline.orchestrator:run_pipeline:207 | PIPELINE EXECUTION COMPLETED
2025-09-30 12:09:38 | INFO     | src.pipeline.orchestrator:run_pipeline:208 | ================================================================================
2025-09-30 12:09:38 | INFO     | src.pipeline.orchestrator:run_pipeline:209 | End time: 2025-09-30 12:09:38.121002
2025-09-30 12:09:38 | INFO     | src.pipeline.orchestrator:run_pipeline:210 | Total execution time: 12.43 seconds
2025-09-30 12:09:38 | INFO     | src.pipeline.orchestrator:run_pipeline:216 | Successful stages: 0
2025-09-30 12:09:38 | INFO     | src.pipeline.orchestrator:run_pipeline:217 | Failed stages: 1
2025-09-30 12:09:38 | INFO     | src.utils.decorators:wrapper:105 | run_pipeline memory usage: -156.48 MB
2025-09-30 12:09:38 | SUCCESS  | src.utils.decorators:wrapper:60 | run_pipeline completed in 12.45 seconds
2025-09-30 12:09:38 | INFO     | src.utils.decorators:wrapper:63 | run_pipeline,12.45
2025-09-30 12:09:38 | INFO     | __main__:main:147 | 
================================================================================
2025-09-30 12:09:38 | INFO     | __main__:main:148 | PIPELINE EXECUTION SUMMARY
2025-09-30 12:09:38 | INFO     | __main__:main:149 | ================================================================================
2025-09-30 12:09:38 | INFO     | __main__:main:154 | Total Stages: 1
2025-09-30 12:09:38 | INFO     | __main__:main:155 | Successful: 0
2025-09-30 12:09:38 | INFO     | __main__:main:156 | Failed: 1
2025-09-30 12:09:38 | INFO     | __main__:main:161 | ✗ data_collection: 12.42s
2025-09-30 12:09:38 | ERROR    | __main__:main:163 |   Error: 'DataCollector' object has no attribute '_collect_marketing'
2025-09-30 12:09:38 | INFO     | __main__:main:168 | 
================================================================================
2025-09-30 12:09:38 | ERROR    | __main__:main:180 | PIPELINE FAILED - Please check the logs for details
2025-09-30 12:09:38 | INFO     | __main__:main:182 | ================================================================================
2025-09-30 12:13:48 | INFO     | __main__:main:113 | ================================================================================
2025-09-30 12:13:48 | INFO     | __main__:main:114 | CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:13:48 | INFO     | __main__:main:115 | ================================================================================
2025-09-30 12:13:48 | INFO     | __main__:main:116 | Environment: development
2025-09-30 12:13:48 | INFO     | __main__:main:117 | Python Version: 3.9.6 (default, Nov 11 2024, 03:15:38) 
[Clang 16.0.0 (clang-1600.0.26.6)]
2025-09-30 12:13:48 | INFO     | __main__:main:118 | Project Root: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project
2025-09-30 12:13:48 | INFO     | __main__:main:119 | Start Time: 2025-09-30 12:13:48.444814
2025-09-30 12:13:48 | INFO     | __main__:main:120 | ================================================================================
2025-09-30 12:13:48 | INFO     | src.pipeline.orchestrator:__init__:76 | Pipeline Orchestrator initialized
2025-09-30 12:13:48 | INFO     | src.utils.decorators:wrapper:55 | Starting run_pipeline...
2025-09-30 12:13:48 | INFO     | src.pipeline.orchestrator:run_pipeline:119 | ================================================================================
2025-09-30 12:13:48 | INFO     | src.pipeline.orchestrator:run_pipeline:120 | STARTING INDUSTRIAL CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:13:48 | INFO     | src.pipeline.orchestrator:run_pipeline:121 | ================================================================================
2025-09-30 12:13:48 | INFO     | src.pipeline.orchestrator:run_pipeline:122 | Start time: 2025-09-30 12:13:48.447089
2025-09-30 12:13:48 | INFO     | src.pipeline.orchestrator:run_pipeline:123 | Environment: development
2025-09-30 12:13:48 | INFO     | src.pipeline.orchestrator:run_pipeline:124 | Configuration loaded from: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/config
2025-09-30 12:13:48 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:13:48 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_COLLECTION
2025-09-30 12:13:48 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:13:48 | INFO     | src.utils.decorators:wrapper:55 | Starting collect_all_data...
2025-09-30 12:13:48 | INFO     | src.data.collector:collect_all_data:48 | Collecting data from sources: ['customers', 'transactions', 'interactions', 'marketing']
2025-09-30 12:13:48 | INFO     | src.data.collector:collect_all_data:49 | Date range: 2023-10-01 to 2025-09-30
2025-09-30 12:13:48 | INFO     | src.utils.database:redis_client:224 | Connected to Redis cache
2025-09-30 12:13:48 | WARNING  | src.utils.database:get_cached_dataframe:260 | Failed to retrieve cached DataFrame: Error 61 connecting to localhost:6379. Connection refused.
2025-09-30 12:13:48 | WARNING  | src.utils.database:get_cached_dataframe:260 | Failed to retrieve cached DataFrame: Error 61 connecting to localhost:6379. Connection refused.
2025-09-30 12:13:48 | WARNING  | src.utils.database:get_cached_dataframe:260 | Failed to retrieve cached DataFrame: Error 61 connecting to localhost:6379. Connection refused.
2025-09-30 12:13:48 | WARNING  | src.utils.database:get_cached_dataframe:260 | Failed to retrieve cached DataFrame: Error 61 connecting to localhost:6379. Connection refused.
2025-09-30 12:13:48 | INFO     | src.utils.database:engine:84 | Created database engine for localhost:5432/crm_analytics
2025-09-30 12:13:48 | INFO     | src.utils.database:engine:84 | Created database engine for localhost:5432/crm_analytics
2025-09-30 12:13:48 | INFO     | src.utils.database:engine:84 | Created database engine for localhost:5432/crm_analytics
2025-09-30 12:13:48 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:13:48 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:13:48 | WARNING  | src.data.collector:_collect_interactions:220 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:13:48 | WARNING  | src.utils.decorators:wrapper:153 | _collect_interactions failed (attempt 1/3). Retrying in 4.0 seconds...
2025-09-30 12:13:48 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:13:48 | WARNING  | src.data.collector:_collect_transactions:184 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:13:48 | WARNING  | src.utils.decorators:wrapper:153 | _collect_transactions failed (attempt 1/3). Retrying in 4.0 seconds...
2025-09-30 12:13:48 | WARNING  | src.data.collector:_collect_customers:143 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:13:48 | INFO     | src.data.collector:_simulate_customers:299 | Simulated 50000 customer records
2025-09-30 12:13:52 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:13:52 | WARNING  | src.data.collector:_collect_interactions:220 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:13:52 | WARNING  | src.utils.decorators:wrapper:153 | _collect_interactions failed (attempt 2/3). Retrying in 8.0 seconds...
2025-09-30 12:13:52 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:13:52 | WARNING  | src.data.collector:_collect_transactions:184 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:13:52 | WARNING  | src.utils.decorators:wrapper:153 | _collect_transactions failed (attempt 2/3). Retrying in 8.0 seconds...
2025-09-30 12:14:00 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:14:00 | WARNING  | src.data.collector:_collect_interactions:220 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:14:00 | ERROR    | src.utils.decorators:wrapper:149 | _collect_interactions failed after 3 attempts
2025-09-30 12:14:00 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-09-30 12:14:00 | WARNING  | src.data.collector:_collect_transactions:184 | Database collection failed: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  role "data_analyst" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8). Using simulated data.
2025-09-30 12:14:00 | ERROR    | src.utils.decorators:wrapper:149 | _collect_transactions failed after 3 attempts
2025-09-30 12:14:00 | ERROR    | src.utils.decorators:wrapper:118 | Error in collect_all_data: 'DataCollector' object has no attribute '_collect_marketing'
2025-09-30 12:14:00 | ERROR    | src.utils.decorators:wrapper:68 | collect_all_data failed after 12.43 seconds: 'DataCollector' object has no attribute '_collect_marketing'
2025-09-30 12:14:00 | ERROR    | src.pipeline.orchestrator:run_pipeline:178 | ✗ Stage data_collection failed: 'DataCollector' object has no attribute '_collect_marketing'
2025-09-30 12:14:00 | INFO     | src.pipeline.orchestrator:_generate_pipeline_report:608 | Pipeline report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/pipeline_report.json
2025-09-30 12:14:00 | INFO     | src.utils.database:close_connections:279 | All database connections closed
2025-09-30 12:14:00 | DEBUG    | src.pipeline.orchestrator:_cleanup:645 | Resources cleaned up
2025-09-30 12:14:00 | INFO     | src.pipeline.orchestrator:run_pipeline:206 | ================================================================================
2025-09-30 12:14:00 | INFO     | src.pipeline.orchestrator:run_pipeline:207 | PIPELINE EXECUTION COMPLETED
2025-09-30 12:14:00 | INFO     | src.pipeline.orchestrator:run_pipeline:208 | ================================================================================
2025-09-30 12:14:00 | INFO     | src.pipeline.orchestrator:run_pipeline:209 | End time: 2025-09-30 12:14:00.882292
2025-09-30 12:14:00 | INFO     | src.pipeline.orchestrator:run_pipeline:210 | Total execution time: 12.44 seconds
2025-09-30 12:14:00 | INFO     | src.pipeline.orchestrator:run_pipeline:216 | Successful stages: 0
2025-09-30 12:14:00 | INFO     | src.pipeline.orchestrator:run_pipeline:217 | Failed stages: 1
2025-09-30 12:14:00 | INFO     | src.utils.decorators:wrapper:105 | run_pipeline memory usage: -140.36 MB
2025-09-30 12:14:00 | SUCCESS  | src.utils.decorators:wrapper:60 | run_pipeline completed in 12.44 seconds
2025-09-30 12:14:00 | INFO     | src.utils.decorators:wrapper:63 | run_pipeline,12.44
2025-09-30 12:14:00 | INFO     | __main__:main:147 | 
================================================================================
2025-09-30 12:14:00 | INFO     | __main__:main:148 | PIPELINE EXECUTION SUMMARY
2025-09-30 12:14:00 | INFO     | __main__:main:149 | ================================================================================
2025-09-30 12:14:00 | INFO     | __main__:main:154 | Total Stages: 1
2025-09-30 12:14:00 | INFO     | __main__:main:155 | Successful: 0
2025-09-30 12:14:00 | INFO     | __main__:main:156 | Failed: 1
2025-09-30 12:14:00 | INFO     | __main__:main:161 | ✗ data_collection: 12.43s
2025-09-30 12:14:00 | ERROR    | __main__:main:163 |   Error: 'DataCollector' object has no attribute '_collect_marketing'
2025-09-30 12:14:00 | INFO     | __main__:main:168 | 
================================================================================
2025-09-30 12:14:00 | ERROR    | __main__:main:180 | PIPELINE FAILED - Please check the logs for details
2025-09-30 12:14:00 | INFO     | __main__:main:182 | ================================================================================
2025-09-30 12:21:46 | INFO     | __main__:main:113 | ================================================================================
2025-09-30 12:21:46 | INFO     | __main__:main:114 | CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:21:46 | INFO     | __main__:main:115 | ================================================================================
2025-09-30 12:21:46 | INFO     | __main__:main:116 | Environment: development
2025-09-30 12:21:46 | INFO     | __main__:main:117 | Python Version: 3.9.6 (default, Nov 11 2024, 03:15:38) 
[Clang 16.0.0 (clang-1600.0.26.6)]
2025-09-30 12:21:46 | INFO     | __main__:main:118 | Project Root: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project
2025-09-30 12:21:46 | INFO     | __main__:main:119 | Start Time: 2025-09-30 12:21:46.535548
2025-09-30 12:21:46 | INFO     | __main__:main:120 | ================================================================================
2025-09-30 12:21:46 | INFO     | src.pipeline.orchestrator:__init__:76 | Pipeline Orchestrator initialized
2025-09-30 12:21:46 | INFO     | src.utils.decorators:wrapper:55 | Starting run_pipeline...
2025-09-30 12:21:46 | INFO     | src.pipeline.orchestrator:run_pipeline:119 | ================================================================================
2025-09-30 12:21:46 | INFO     | src.pipeline.orchestrator:run_pipeline:120 | STARTING INDUSTRIAL CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:21:46 | INFO     | src.pipeline.orchestrator:run_pipeline:121 | ================================================================================
2025-09-30 12:21:46 | INFO     | src.pipeline.orchestrator:run_pipeline:122 | Start time: 2025-09-30 12:21:46.536452
2025-09-30 12:21:46 | INFO     | src.pipeline.orchestrator:run_pipeline:123 | Environment: development
2025-09-30 12:21:46 | INFO     | src.pipeline.orchestrator:run_pipeline:124 | Configuration loaded from: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/config
2025-09-30 12:21:46 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:21:46 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_COLLECTION
2025-09-30 12:21:46 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:21:46 | INFO     | src.utils.decorators:wrapper:55 | Starting collect_all_data...
2025-09-30 12:21:46 | INFO     | src.data.collector:collect_all_data:48 | Collecting data from sources: ['customers', 'transactions', 'interactions', 'marketing']
2025-09-30 12:21:46 | INFO     | src.data.collector:collect_all_data:49 | Date range: 2023-10-01 to 2025-09-30
2025-09-30 12:21:46 | INFO     | src.utils.database:redis_client:224 | Connected to Redis cache
2025-09-30 12:21:46 | INFO     | src.utils.database:engine:84 | Created database engine for localhost:5432/crm_analytics
2025-09-30 12:21:46 | INFO     | src.utils.database:engine:84 | Created database engine for localhost:5432/crm_analytics
2025-09-30 12:21:46 | INFO     | src.utils.database:engine:84 | Created database engine for localhost:5432/crm_analytics
2025-09-30 12:21:46 | INFO     | src.utils.database:engine:84 | Created database engine for localhost:5432/crm_analytics
2025-09-30 12:21:46 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.errors.UndefinedTable) relation "customer_interactions" does not exist
LINE 18:         FROM customer_interactions
                      ^

[SQL: 
        SELECT 
            interaction_id,
            customer_id,
            interaction_date,
            interaction_type,
            interaction_subtype,
            channel,
            agent_id,
            duration_seconds,
            wait_time_seconds,
            resolution_status,
            satisfaction_score,
            nps_score,
            sentiment_score,
            ticket_id,
            tags
        FROM customer_interactions
        WHERE interaction_date BETWEEN %(start_date)s AND %(end_date)s
        ]
[parameters: {'start_date': datetime.datetime(2023, 10, 1, 12, 21, 46, 537658), 'end_date': datetime.datetime(2025, 9, 30, 12, 21, 46, 537658)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-30 12:21:46 | WARNING  | src.data.collector:_collect_interactions:220 | Database collection failed: (psycopg2.errors.UndefinedTable) relation "customer_interactions" does not exist
LINE 18:         FROM customer_interactions
                      ^

[SQL: 
        SELECT 
            interaction_id,
            customer_id,
            interaction_date,
            interaction_type,
            interaction_subtype,
            channel,
            agent_id,
            duration_seconds,
            wait_time_seconds,
            resolution_status,
            satisfaction_score,
            nps_score,
            sentiment_score,
            ticket_id,
            tags
        FROM customer_interactions
        WHERE interaction_date BETWEEN %(start_date)s AND %(end_date)s
        ]
[parameters: {'start_date': datetime.datetime(2023, 10, 1, 12, 21, 46, 537658), 'end_date': datetime.datetime(2025, 9, 30, 12, 21, 46, 537658)}]
(Background on this error at: https://sqlalche.me/e/20/f405). Using simulated data.
2025-09-30 12:21:46 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.errors.UndefinedTable) relation "transactions" does not exist
LINE 21:         FROM transactions t
                      ^

[SQL: 
        SELECT 
            t.transaction_id,
            t.customer_id,
            t.transaction_date,
            t.product_id,
            p.product_name,
            p.product_category,
            p.product_subcategory,
            t.quantity,
            t.unit_price,
            t.total_amount,
            t.discount_amount,
            t.tax_amount,
            t.payment_method,
            t.payment_status,
            t.transaction_status,
            t.channel,
            t.device_type,
            t.session_id
        FROM transactions t
        LEFT JOIN products p ON t.product_id = p.product_id
        WHERE t.transaction_date BETWEEN %(start_date)s AND %(end_date)s
            AND t.transaction_status = 'completed'
        ]
[parameters: {'start_date': datetime.datetime(2023, 10, 1, 12, 21, 46, 537658), 'end_date': datetime.datetime(2025, 9, 30, 12, 21, 46, 537658)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-30 12:21:46 | WARNING  | src.utils.decorators:wrapper:153 | _collect_interactions failed (attempt 1/3). Retrying in 4.0 seconds...
2025-09-30 12:21:46 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.errors.UndefinedTable) relation "customers" does not exist
LINE 25:         FROM customers
                      ^

[SQL: 
        SELECT 
            customer_id,
            registration_date,
            date_of_birth,
            age,
            gender,
            country,
            state,
            city,
            postal_code,
            acquisition_channel,
            acquisition_campaign,
            customer_segment,
            customer_tier,
            lifetime_value,
            preferred_contact_method,
            email_verified,
            phone_verified,
            account_status,
            churn_date,
            churned,
            created_at,
            updated_at
        FROM customers
        WHERE registration_date BETWEEN %(start_date)s AND %(end_date)s
            AND account_status NOT IN ('test', 'deleted')
        ]
[parameters: {'start_date': datetime.datetime(2023, 10, 1, 12, 21, 46, 537658), 'end_date': datetime.datetime(2025, 9, 30, 12, 21, 46, 537658)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-30 12:21:46 | WARNING  | src.data.collector:_collect_transactions:184 | Database collection failed: (psycopg2.errors.UndefinedTable) relation "transactions" does not exist
LINE 21:         FROM transactions t
                      ^

[SQL: 
        SELECT 
            t.transaction_id,
            t.customer_id,
            t.transaction_date,
            t.product_id,
            p.product_name,
            p.product_category,
            p.product_subcategory,
            t.quantity,
            t.unit_price,
            t.total_amount,
            t.discount_amount,
            t.tax_amount,
            t.payment_method,
            t.payment_status,
            t.transaction_status,
            t.channel,
            t.device_type,
            t.session_id
        FROM transactions t
        LEFT JOIN products p ON t.product_id = p.product_id
        WHERE t.transaction_date BETWEEN %(start_date)s AND %(end_date)s
            AND t.transaction_status = 'completed'
        ]
[parameters: {'start_date': datetime.datetime(2023, 10, 1, 12, 21, 46, 537658), 'end_date': datetime.datetime(2025, 9, 30, 12, 21, 46, 537658)}]
(Background on this error at: https://sqlalche.me/e/20/f405). Using simulated data.
2025-09-30 12:21:46 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.errors.UndefinedTable) relation "marketing_campaigns" does not exist
LINE 18:         FROM marketing_campaigns mc
                      ^

[SQL: 
        SELECT 
            mc.campaign_id,
            mc.customer_id,
            mc.campaign_date,
            mc.campaign_type,
            mc.campaign_name,
            mc.campaign_category,
            mc.channel,
            mc.sent,
            mc.opened,
            mc.clicked,
            mc.converted,
            mc.unsubscribed,
            mc.bounced,
            mc.cost,
            mc.revenue_attributed
        FROM marketing_campaigns mc
        WHERE mc.campaign_date BETWEEN %(start_date)s AND %(end_date)s
            AND mc.sent = true
        ]
[parameters: {'start_date': datetime.datetime(2023, 10, 1, 12, 21, 46, 537658), 'end_date': datetime.datetime(2025, 9, 30, 12, 21, 46, 537658)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-30 12:21:46 | WARNING  | src.data.collector:_collect_customers:143 | Database collection failed: (psycopg2.errors.UndefinedTable) relation "customers" does not exist
LINE 25:         FROM customers
                      ^

[SQL: 
        SELECT 
            customer_id,
            registration_date,
            date_of_birth,
            age,
            gender,
            country,
            state,
            city,
            postal_code,
            acquisition_channel,
            acquisition_campaign,
            customer_segment,
            customer_tier,
            lifetime_value,
            preferred_contact_method,
            email_verified,
            phone_verified,
            account_status,
            churn_date,
            churned,
            created_at,
            updated_at
        FROM customers
        WHERE registration_date BETWEEN %(start_date)s AND %(end_date)s
            AND account_status NOT IN ('test', 'deleted')
        ]
[parameters: {'start_date': datetime.datetime(2023, 10, 1, 12, 21, 46, 537658), 'end_date': datetime.datetime(2025, 9, 30, 12, 21, 46, 537658)}]
(Background on this error at: https://sqlalche.me/e/20/f405). Using simulated data.
2025-09-30 12:21:46 | WARNING  | src.utils.decorators:wrapper:153 | _collect_transactions failed (attempt 1/3). Retrying in 4.0 seconds...
2025-09-30 12:21:46 | WARNING  | src.data.collector:_collect_marketing:257 | Database collection failed: (psycopg2.errors.UndefinedTable) relation "marketing_campaigns" does not exist
LINE 18:         FROM marketing_campaigns mc
                      ^

[SQL: 
        SELECT 
            mc.campaign_id,
            mc.customer_id,
            mc.campaign_date,
            mc.campaign_type,
            mc.campaign_name,
            mc.campaign_category,
            mc.channel,
            mc.sent,
            mc.opened,
            mc.clicked,
            mc.converted,
            mc.unsubscribed,
            mc.bounced,
            mc.cost,
            mc.revenue_attributed
        FROM marketing_campaigns mc
        WHERE mc.campaign_date BETWEEN %(start_date)s AND %(end_date)s
            AND mc.sent = true
        ]
[parameters: {'start_date': datetime.datetime(2023, 10, 1, 12, 21, 46, 537658), 'end_date': datetime.datetime(2025, 9, 30, 12, 21, 46, 537658)}]
(Background on this error at: https://sqlalche.me/e/20/f405). Using simulated data.
2025-09-30 12:21:46 | INFO     | src.utils.database:cache_dataframe:239 | Cached DataFrame with key: raw_marketing
2025-09-30 12:21:46 | SUCCESS  | src.data.collector:collect_all_data:90 | Collected marketing: 0 records
2025-09-30 12:21:46 | INFO     | src.data.collector:_simulate_customers:336 | Simulated 50000 customer records
2025-09-30 12:21:46 | INFO     | src.utils.database:cache_dataframe:239 | Cached DataFrame with key: raw_customers
2025-09-30 12:21:46 | SUCCESS  | src.data.collector:collect_all_data:90 | Collected customers: 50000 records
2025-09-30 12:21:50 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.errors.UndefinedTable) relation "transactions" does not exist
LINE 21:         FROM transactions t
                      ^

[SQL: 
        SELECT 
            t.transaction_id,
            t.customer_id,
            t.transaction_date,
            t.product_id,
            p.product_name,
            p.product_category,
            p.product_subcategory,
            t.quantity,
            t.unit_price,
            t.total_amount,
            t.discount_amount,
            t.tax_amount,
            t.payment_method,
            t.payment_status,
            t.transaction_status,
            t.channel,
            t.device_type,
            t.session_id
        FROM transactions t
        LEFT JOIN products p ON t.product_id = p.product_id
        WHERE t.transaction_date BETWEEN %(start_date)s AND %(end_date)s
            AND t.transaction_status = 'completed'
        ]
[parameters: {'start_date': datetime.datetime(2023, 10, 1, 12, 21, 46, 537658), 'end_date': datetime.datetime(2025, 9, 30, 12, 21, 46, 537658)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-30 12:21:50 | ERROR    | src.utils.database:execute_query:137 | Query execution failed: (psycopg2.errors.UndefinedTable) relation "customer_interactions" does not exist
LINE 18:         FROM customer_interactions
                      ^

[SQL: 
        SELECT 
            interaction_id,
            customer_id,
            interaction_date,
            interaction_type,
            interaction_subtype,
            channel,
            agent_id,
            duration_seconds,
            wait_time_seconds,
            resolution_status,
            satisfaction_score,
            nps_score,
            sentiment_score,
            ticket_id,
            tags
        FROM customer_interactions
        WHERE interaction_date BETWEEN %(start_date)s AND %(end_date)s
        ]
[parameters: {'start_date': datetime.datetime(2023, 10, 1, 12, 21, 46, 537658), 'end_date': datetime.datetime(2025, 9, 30, 12, 21, 46, 537658)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-30 12:21:50 | WARNING  | src.data.collector:_collect_transactions:184 | Database collection failed: (psycopg2.errors.UndefinedTable) relation "transactions" does not exist
LINE 21:         FROM transactions t
                      ^

[SQL: 
        SELECT 
            t.transaction_id,
            t.customer_id,
            t.transaction_date,
            t.product_id,
            p.product_name,
            p.product_category,
            p.product_subcategory,
            t.quantity,
            t.unit_price,
            t.total_amount,
            t.discount_amount,
            t.tax_amount,
            t.payment_method,
            t.payment_status,
            t.transaction_status,
            t.channel,
            t.device_type,
            t.session_id
        FROM transactions t
        LEFT JOIN products p ON t.product_id = p.product_id
        WHERE t.transaction_date BETWEEN %(start_date)s AND %(end_date)s
            AND t.transaction_status = 'completed'
        ]
[parameters: {'start_date': datetime.datetime(2023, 10, 1, 12, 21, 46, 537658), 'end_date': datetime.datetime(2025, 9, 30, 12, 21, 46, 537658)}]
(Background on this error at: https://sqlalche.me/e/20/f405). Using simulated data.
2025-09-30 12:21:50 | WARNING  | src.data.collector:_collect_interactions:220 | Database collection failed: (psycopg2.errors.UndefinedTable) relation "customer_interactions" does not exist
LINE 18:         FROM customer_interactions
                      ^

[SQL: 
        SELECT 
            interaction_id,
            customer_id,
            interaction_date,
            interaction_type,
            interaction_subtype,
            channel,
            agent_id,
            duration_seconds,
            wait_time_seconds,
            resolution_status,
            satisfaction_score,
            nps_score,
            sentiment_score,
            ticket_id,
            tags
        FROM customer_interactions
        WHERE interaction_date BETWEEN %(start_date)s AND %(end_date)s
        ]
[parameters: {'start_date': datetime.datetime(2023, 10, 1, 12, 21, 46, 537658), 'end_date': datetime.datetime(2025, 9, 30, 12, 21, 46, 537658)}]
(Background on this error at: https://sqlalche.me/e/20/f405). Using simulated data.
2025-09-30 12:22:28 | INFO     | src.data.collector:_simulate_interactions:446 | Simulated 254885 interaction records
2025-09-30 12:22:29 | INFO     | src.utils.database:cache_dataframe:239 | Cached DataFrame with key: raw_interactions
2025-09-30 12:22:29 | SUCCESS  | src.data.collector:collect_all_data:90 | Collected interactions: 254885 records
2025-09-30 12:23:18 | INFO     | src.data.collector:_simulate_transactions:390 | Simulated 745616 transaction records
2025-09-30 12:23:19 | INFO     | src.utils.database:cache_dataframe:239 | Cached DataFrame with key: raw_transactions
2025-09-30 12:23:19 | SUCCESS  | src.data.collector:collect_all_data:90 | Collected transactions: 745616 records
2025-09-30 12:23:20 | INFO     | src.data.collector:_save_raw_data:500 | Saved marketing to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/marketing_raw.parquet
2025-09-30 12:23:20 | INFO     | src.data.collector:_save_raw_data:500 | Saved customers to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/customers_raw.parquet
2025-09-30 12:23:20 | INFO     | src.data.collector:_save_raw_data:500 | Saved interactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/interactions_raw.parquet
2025-09-30 12:23:21 | INFO     | src.data.collector:_save_raw_data:500 | Saved transactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/transactions_raw.parquet
2025-09-30 12:23:21 | INFO     | src.utils.decorators:wrapper:105 | collect_all_data memory usage: 751.08 MB
2025-09-30 12:23:21 | WARNING  | src.utils.decorators:wrapper:110 | High memory usage detected (751.08 MB). Running garbage collection.
2025-09-30 12:23:21 | SUCCESS  | src.utils.decorators:wrapper:60 | collect_all_data completed in 94.74 seconds
2025-09-30 12:23:21 | INFO     | src.utils.decorators:wrapper:63 | collect_all_data,94.74
2025-09-30 12:23:22 | SUCCESS  | src.pipeline.orchestrator:run_pipeline:172 | ✓ Stage data_collection completed successfully
2025-09-30 12:23:44 | DEBUG    | src.pipeline.orchestrator:_save_checkpoint:567 | Saved checkpoint for stage data_collection
2025-09-30 12:23:44 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:23:44 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_CLEANING
2025-09-30 12:23:44 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:23:44 | INFO     | src.utils.decorators:wrapper:55 | Starting clean_all_data...
2025-09-30 12:23:44 | INFO     | src.data.cleaner:clean_all_data:47 | ==================================================
2025-09-30 12:23:44 | INFO     | src.data.cleaner:clean_all_data:48 | Starting Industial Data Cleaning Pipeline
2025-09-30 12:23:44 | INFO     | src.data.cleaner:clean_all_data:49 | ==================================================
2025-09-30 12:23:44 | INFO     | src.data.cleaner:clean_all_data:54 | 
Cleaning marketing dataset...
2025-09-30 12:23:44 | INFO     | src.data.cleaner:clean_all_data:55 | Initial shape: (0, 0)
2025-09-30 12:23:44 | INFO     | src.data.cleaner:clean_all_data:85 | Cleaned shape: (0, 0)
2025-09-30 12:23:44 | INFO     | src.data.cleaner:clean_all_data:86 | Records removed: 0
2025-09-30 12:23:44 | INFO     | src.data.cleaner:clean_all_data:54 | 
Cleaning customers dataset...
2025-09-30 12:23:44 | INFO     | src.data.cleaner:clean_all_data:55 | Initial shape: (50000, 12)
2025-09-30 12:23:44 | ERROR    | src.utils.decorators:wrapper:118 | Error in clean_all_data: Cannot perform 'ror_' with a dtyped [float64] array and scalar of type [bool]
2025-09-30 12:23:44 | ERROR    | src.utils.decorators:wrapper:68 | clean_all_data failed after 0.05 seconds: Cannot perform 'ror_' with a dtyped [float64] array and scalar of type [bool]
2025-09-30 12:23:44 | ERROR    | src.pipeline.orchestrator:run_pipeline:178 | ✗ Stage data_cleaning failed: Cannot perform 'ror_' with a dtyped [float64] array and scalar of type [bool]
2025-09-30 12:23:44 | INFO     | src.pipeline.orchestrator:_generate_pipeline_report:608 | Pipeline report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/pipeline_report.json
2025-09-30 12:23:44 | INFO     | src.utils.database:close_connections:279 | All database connections closed
2025-09-30 12:23:44 | DEBUG    | src.pipeline.orchestrator:_cleanup:645 | Resources cleaned up
2025-09-30 12:23:44 | INFO     | src.pipeline.orchestrator:run_pipeline:206 | ================================================================================
2025-09-30 12:23:44 | INFO     | src.pipeline.orchestrator:run_pipeline:207 | PIPELINE EXECUTION COMPLETED
2025-09-30 12:23:44 | INFO     | src.pipeline.orchestrator:run_pipeline:208 | ================================================================================
2025-09-30 12:23:44 | INFO     | src.pipeline.orchestrator:run_pipeline:209 | End time: 2025-09-30 12:23:44.376727
2025-09-30 12:23:44 | INFO     | src.pipeline.orchestrator:run_pipeline:210 | Total execution time: 117.84 seconds
2025-09-30 12:23:44 | INFO     | src.pipeline.orchestrator:run_pipeline:216 | Successful stages: 1
2025-09-30 12:23:44 | INFO     | src.pipeline.orchestrator:run_pipeline:217 | Failed stages: 1
2025-09-30 12:23:44 | INFO     | src.utils.decorators:wrapper:105 | run_pipeline memory usage: 862.17 MB
2025-09-30 12:23:44 | WARNING  | src.utils.decorators:wrapper:110 | High memory usage detected (862.17 MB). Running garbage collection.
2025-09-30 12:23:44 | SUCCESS  | src.utils.decorators:wrapper:60 | run_pipeline completed in 117.93 seconds
2025-09-30 12:23:44 | INFO     | src.utils.decorators:wrapper:63 | run_pipeline,117.93
2025-09-30 12:23:44 | INFO     | __main__:main:147 | 
================================================================================
2025-09-30 12:23:44 | INFO     | __main__:main:148 | PIPELINE EXECUTION SUMMARY
2025-09-30 12:23:44 | INFO     | __main__:main:149 | ================================================================================
2025-09-30 12:23:44 | INFO     | __main__:main:154 | Total Stages: 2
2025-09-30 12:23:44 | INFO     | __main__:main:155 | Successful: 1
2025-09-30 12:23:44 | INFO     | __main__:main:156 | Failed: 1
2025-09-30 12:23:44 | INFO     | __main__:main:161 | ✓ data_collection: 96.05s
2025-09-30 12:23:44 | INFO     | __main__:main:161 | ✗ data_cleaning: 0.05s
2025-09-30 12:23:44 | ERROR    | __main__:main:163 |   Error: Cannot perform 'ror_' with a dtyped [float64] array and scalar of type [bool]
2025-09-30 12:23:44 | INFO     | __main__:main:168 | 
================================================================================
2025-09-30 12:23:44 | ERROR    | __main__:main:180 | PIPELINE FAILED - Please check the logs for details
2025-09-30 12:23:44 | INFO     | __main__:main:182 | ================================================================================
2025-09-30 12:26:35 | INFO     | __main__:main:113 | ================================================================================
2025-09-30 12:26:35 | INFO     | __main__:main:114 | CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:26:35 | INFO     | __main__:main:115 | ================================================================================
2025-09-30 12:26:35 | INFO     | __main__:main:116 | Environment: development
2025-09-30 12:26:35 | INFO     | __main__:main:117 | Python Version: 3.9.6 (default, Nov 11 2024, 03:15:38) 
[Clang 16.0.0 (clang-1600.0.26.6)]
2025-09-30 12:26:35 | INFO     | __main__:main:118 | Project Root: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project
2025-09-30 12:26:35 | INFO     | __main__:main:119 | Start Time: 2025-09-30 12:26:35.977077
2025-09-30 12:26:35 | INFO     | __main__:main:120 | ================================================================================
2025-09-30 12:26:35 | INFO     | src.pipeline.orchestrator:__init__:76 | Pipeline Orchestrator initialized
2025-09-30 12:26:35 | INFO     | src.utils.decorators:wrapper:55 | Starting run_pipeline...
2025-09-30 12:26:35 | INFO     | src.pipeline.orchestrator:run_pipeline:119 | ================================================================================
2025-09-30 12:26:35 | INFO     | src.pipeline.orchestrator:run_pipeline:120 | STARTING INDUSTRIAL CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:26:35 | INFO     | src.pipeline.orchestrator:run_pipeline:121 | ================================================================================
2025-09-30 12:26:35 | INFO     | src.pipeline.orchestrator:run_pipeline:122 | Start time: 2025-09-30 12:26:35.977766
2025-09-30 12:26:35 | INFO     | src.pipeline.orchestrator:run_pipeline:123 | Environment: development
2025-09-30 12:26:35 | INFO     | src.pipeline.orchestrator:run_pipeline:124 | Configuration loaded from: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/config
2025-09-30 12:26:35 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:26:35 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_COLLECTION
2025-09-30 12:26:35 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:26:35 | INFO     | src.utils.decorators:wrapper:55 | Starting collect_all_data...
2025-09-30 12:26:35 | INFO     | src.data.collector:collect_all_data:48 | Collecting data from sources: ['customers', 'transactions', 'interactions', 'marketing']
2025-09-30 12:26:35 | INFO     | src.data.collector:collect_all_data:49 | Date range: 2023-10-01 to 2025-09-30
2025-09-30 12:26:35 | INFO     | src.utils.database:redis_client:224 | Connected to Redis cache
2025-09-30 12:26:36 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_customers
2025-09-30 12:26:36 | INFO     | src.data.collector:collect_all_data:61 | Loaded customers from cache: 50000 records
2025-09-30 12:26:40 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_transactions
2025-09-30 12:26:40 | INFO     | src.data.collector:collect_all_data:61 | Loaded transactions from cache: 745616 records
2025-09-30 12:26:41 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_interactions
2025-09-30 12:26:41 | INFO     | src.data.collector:collect_all_data:61 | Loaded interactions from cache: 254885 records
2025-09-30 12:26:41 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_marketing
2025-09-30 12:26:41 | INFO     | src.data.collector:collect_all_data:61 | Loaded marketing from cache: 0 records
2025-09-30 12:26:41 | INFO     | src.data.collector:_save_raw_data:500 | Saved customers to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/customers_raw.parquet
2025-09-30 12:26:42 | INFO     | src.data.collector:_save_raw_data:500 | Saved transactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/transactions_raw.parquet
2025-09-30 12:26:42 | INFO     | src.data.collector:_save_raw_data:500 | Saved interactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/interactions_raw.parquet
2025-09-30 12:26:42 | INFO     | src.data.collector:_save_raw_data:500 | Saved marketing to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/marketing_raw.parquet
2025-09-30 12:26:42 | INFO     | src.utils.decorators:wrapper:105 | collect_all_data memory usage: 761.66 MB
2025-09-30 12:26:42 | WARNING  | src.utils.decorators:wrapper:110 | High memory usage detected (761.66 MB). Running garbage collection.
2025-09-30 12:26:42 | SUCCESS  | src.utils.decorators:wrapper:60 | collect_all_data completed in 6.97 seconds
2025-09-30 12:26:42 | INFO     | src.utils.decorators:wrapper:63 | collect_all_data,6.97
2025-09-30 12:26:45 | SUCCESS  | src.pipeline.orchestrator:run_pipeline:172 | ✓ Stage data_collection completed successfully
2025-09-30 12:26:47 | DEBUG    | src.pipeline.orchestrator:_save_checkpoint:567 | Saved checkpoint for stage data_collection
2025-09-30 12:26:47 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:26:47 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_CLEANING
2025-09-30 12:26:47 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:26:47 | INFO     | src.utils.decorators:wrapper:55 | Starting clean_all_data...
2025-09-30 12:26:47 | INFO     | src.data.cleaner:clean_all_data:47 | ==================================================
2025-09-30 12:26:47 | INFO     | src.data.cleaner:clean_all_data:48 | Starting Industial Data Cleaning Pipeline
2025-09-30 12:26:47 | INFO     | src.data.cleaner:clean_all_data:49 | ==================================================
2025-09-30 12:26:47 | INFO     | src.data.cleaner:clean_all_data:54 | 
Cleaning customers dataset...
2025-09-30 12:26:47 | INFO     | src.data.cleaner:clean_all_data:55 | Initial shape: (50000, 12)
2025-09-30 12:26:47 | INFO     | src.data.cleaner:_handle_outliers_iqr:475 | Capped 326 outliers in age
2025-09-30 12:26:47 | INFO     | src.data.cleaner:clean_all_data:85 | Cleaned shape: (50000, 17)
2025-09-30 12:26:47 | INFO     | src.data.cleaner:clean_all_data:86 | Records removed: 0
2025-09-30 12:26:47 | INFO     | src.data.cleaner:clean_all_data:54 | 
Cleaning transactions dataset...
2025-09-30 12:26:47 | INFO     | src.data.cleaner:clean_all_data:55 | Initial shape: (745616, 9)
2025-09-30 12:26:48 | INFO     | src.data.cleaner:_handle_outliers_iqr:475 | Capped 33848 outliers in total_amount
2025-09-30 12:26:49 | INFO     | src.data.cleaner:clean_all_data:85 | Cleaned shape: (745616, 15)
2025-09-30 12:26:49 | INFO     | src.data.cleaner:clean_all_data:86 | Records removed: 0
2025-09-30 12:26:49 | INFO     | src.data.cleaner:clean_all_data:54 | 
Cleaning interactions dataset...
2025-09-30 12:26:49 | INFO     | src.data.cleaner:clean_all_data:55 | Initial shape: (254885, 8)
2025-09-30 12:26:49 | INFO     | src.data.cleaner:clean_all_data:85 | Cleaned shape: (254885, 10)
2025-09-30 12:26:49 | INFO     | src.data.cleaner:clean_all_data:86 | Records removed: 0
2025-09-30 12:26:49 | INFO     | src.data.cleaner:clean_all_data:54 | 
Cleaning marketing dataset...
2025-09-30 12:26:49 | INFO     | src.data.cleaner:clean_all_data:55 | Initial shape: (0, 0)
2025-09-30 12:26:49 | INFO     | src.data.cleaner:clean_all_data:85 | Cleaned shape: (0, 0)
2025-09-30 12:26:49 | INFO     | src.data.cleaner:clean_all_data:86 | Records removed: 0
2025-09-30 12:26:49 | INFO     | src.data.cleaner:_save_cleaned_data:484 | Saved cleaned customers to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/customers_cleaned.parquet
2025-09-30 12:26:49 | INFO     | src.data.cleaner:_save_cleaned_data:484 | Saved cleaned transactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/transactions_cleaned.parquet
2025-09-30 12:26:50 | INFO     | src.data.cleaner:_save_cleaned_data:484 | Saved cleaned interactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/interactions_cleaned.parquet
2025-09-30 12:26:50 | INFO     | src.data.cleaner:_save_cleaned_data:484 | Saved cleaned marketing to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/marketing_cleaned.parquet
2025-09-30 12:26:50 | INFO     | src.data.cleaner:_generate_cleaning_report:519 | Cleaning report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/cleaning_report.txt
2025-09-30 12:26:50 | INFO     | src.utils.decorators:wrapper:105 | clean_all_data memory usage: 190.58 MB
2025-09-30 12:26:50 | SUCCESS  | src.utils.decorators:wrapper:60 | clean_all_data completed in 2.61 seconds
2025-09-30 12:26:50 | INFO     | src.utils.decorators:wrapper:63 | clean_all_data,2.61
2025-09-30 12:26:50 | SUCCESS  | src.pipeline.orchestrator:run_pipeline:172 | ✓ Stage data_cleaning completed successfully
2025-09-30 12:26:53 | DEBUG    | src.pipeline.orchestrator:_save_checkpoint:567 | Saved checkpoint for stage data_cleaning
2025-09-30 12:26:53 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:26:53 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_VALIDATION
2025-09-30 12:26:53 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:26:53 | INFO     | src.data.validator:validate_data:47 | Starting validation for dataset
2025-09-30 12:26:53 | INFO     | src.data.validator:validate_data:69 | Validation complete for dataset: 0 errors, 1 warnings
2025-09-30 12:26:53 | WARNING  | src.data.validator:validate_data:75 | ⚠️  high_cardinality_customer_id: Column 'customer_id' has very high cardinality (50,000 unique values)
2025-09-30 12:26:53 | INFO     | src.data.validator:validate_data:47 | Starting validation for dataset
2025-09-30 12:26:59 | INFO     | src.data.validator:validate_data:69 | Validation complete for dataset: 1 errors, 1 warnings
2025-09-30 12:26:59 | ERROR    | src.data.validator:validate_data:72 | ❌ duplicate_ids_customer_id: Found 695,654 duplicate values in ID column 'customer_id'
2025-09-30 12:26:59 | WARNING  | src.data.validator:validate_data:75 | ⚠️  high_cardinality_transaction_id: Column 'transaction_id' has very high cardinality (745,616 unique values)
2025-09-30 12:26:59 | WARNING  | src.pipeline.orchestrator:_run_data_validation:341 | Dataset transactions failed validation
2025-09-30 12:26:59 | INFO     | src.data.validator:validate_data:47 | Starting validation for dataset
2025-09-30 12:27:00 | INFO     | src.data.validator:validate_data:69 | Validation complete for dataset: 1 errors, 1 warnings
2025-09-30 12:27:00 | ERROR    | src.data.validator:validate_data:72 | ❌ duplicate_ids_customer_id: Found 204,923 duplicate values in ID column 'customer_id'
2025-09-30 12:27:00 | WARNING  | src.data.validator:validate_data:75 | ⚠️  high_cardinality_interaction_id: Column 'interaction_id' has very high cardinality (254,885 unique values)
2025-09-30 12:27:00 | WARNING  | src.pipeline.orchestrator:_run_data_validation:341 | Dataset interactions failed validation
2025-09-30 12:27:00 | INFO     | src.data.validator:validate_data:47 | Starting validation for dataset
2025-09-30 12:27:00 | INFO     | src.data.validator:validate_data:69 | Validation complete for dataset: 1 errors, 1 warnings
2025-09-30 12:27:00 | ERROR    | src.data.validator:validate_data:72 | ❌ empty_dataframe: DataFrame dataset is empty
2025-09-30 12:27:00 | WARNING  | src.data.validator:validate_data:75 | ⚠️  sample_size: Dataset has only 0 records (minimum recommended: 1,000)
2025-09-30 12:27:00 | WARNING  | src.pipeline.orchestrator:_run_data_validation:341 | Dataset marketing failed validation
2025-09-30 12:27:00 | ERROR    | src.pipeline.orchestrator:run_pipeline:178 | ✗ Stage data_validation failed: None
2025-09-30 12:27:00 | INFO     | src.pipeline.orchestrator:_generate_pipeline_report:608 | Pipeline report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/pipeline_report.json
2025-09-30 12:27:00 | ERROR    | src.utils.decorators:wrapper:118 | Error in run_pipeline: Object of type CleaningReport is not JSON serializable
2025-09-30 12:27:00 | ERROR    | src.utils.decorators:wrapper:68 | run_pipeline failed after 24.41 seconds: Object of type CleaningReport is not JSON serializable
2025-09-30 12:27:00 | ERROR    | __main__:main:187 | Pipeline execution failed: Object of type CleaningReport is not JSON serializable
2025-09-30 12:27:00 | ERROR    | __main__:main:188 | Object of type CleaningReport is not JSON serializable
Traceback (most recent call last):

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/scripts/run_pipeline.py", line 193, in <module>
    main()
    └ <function main at 0x14b1f9ee0>

> File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/scripts/run_pipeline.py", line 140, in main
    results = orchestrator.run_pipeline(
              │            └ <function PipelineOrchestrator.run_pipeline at 0x14b1e5dc0>
              └ <src.pipeline.orchestrator.PipelineOrchestrator object at 0x14b1fdfd0>

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/src/utils/decorators.py", line 58, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {'stages': None, 'resume_from': None, 'use_cache': True, 'continue_on_error': False, 'generate_plots': True, 'deep_clean': Tr...
             │     └ (<src.pipeline.orchestrator.PipelineOrchestrator object at 0x14b1fdfd0>,)
             └ <function PipelineOrchestrator.run_pipeline at 0x14b1e5d30>

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/src/utils/decorators.py", line 99, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {'stages': None, 'resume_from': None, 'use_cache': True, 'continue_on_error': False, 'generate_plots': True, 'deep_clean': Tr...
             │     └ (<src.pipeline.orchestrator.PipelineOrchestrator object at 0x14b1fdfd0>,)
             └ <function PipelineOrchestrator.run_pipeline at 0x14b1e5b80>

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/src/pipeline/orchestrator.py", line 198, in run_pipeline
    self._generate_pipeline_report()
    │    └ <function PipelineOrchestrator._generate_pipeline_report at 0x14b1ea310>
    └ <src.pipeline.orchestrator.PipelineOrchestrator object at 0x14b1fdfd0>

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/src/pipeline/orchestrator.py", line 630, in _generate_pipeline_report
    f.write(f"  Metadata: {json.dumps(result.metadata, indent=4)}\n")
    │ └ <method 'write' of '_io.TextIOWrapper' objects>
    └ <_io.TextIOWrapper name='/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/pipelin...

  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/__init__.py", line 234, in dumps
    return cls(
           └ <class 'json.encoder.JSONEncoder'>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 201, in encode
    chunks = list(chunks)
                  └ <generator object _make_iterencode.<locals>._iterencode at 0x16aec7f90>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
               │                │  └ 0
               │                └ {'cleaning_reports': {'customers': CleaningReport(total_records_before=50000, total_records_after=50000, duplicates_removed=0...
               └ <function _make_iterencode.<locals>._iterencode_dict at 0x16c0f0790>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
               └ <generator object _make_iterencode.<locals>._iterencode_dict at 0x314235040>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
               └ <generator object _make_iterencode.<locals>._iterencode at 0x314235120>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 438, in _iterencode
    o = _default(o)
        │        └ CleaningReport(total_records_before=50000, total_records_after=50000, duplicates_removed=0, missing_values_handled={}, outlie...
        └ <bound method JSONEncoder.default of <json.encoder.JSONEncoder object at 0x313df6340>>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type CleaningReport is not JSON serializable
2025-09-30 12:31:41 | INFO     | __main__:main:113 | ================================================================================
2025-09-30 12:31:41 | INFO     | __main__:main:114 | CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:31:41 | INFO     | __main__:main:115 | ================================================================================
2025-09-30 12:31:41 | INFO     | __main__:main:116 | Environment: development
2025-09-30 12:31:41 | INFO     | __main__:main:117 | Python Version: 3.9.6 (default, Nov 11 2024, 03:15:38) 
[Clang 16.0.0 (clang-1600.0.26.6)]
2025-09-30 12:31:41 | INFO     | __main__:main:118 | Project Root: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project
2025-09-30 12:31:41 | INFO     | __main__:main:119 | Start Time: 2025-09-30 12:31:41.352903
2025-09-30 12:31:41 | INFO     | __main__:main:120 | ================================================================================
2025-09-30 12:31:41 | INFO     | src.pipeline.orchestrator:__init__:76 | Pipeline Orchestrator initialized
2025-09-30 12:31:41 | INFO     | src.utils.decorators:wrapper:55 | Starting run_pipeline...
2025-09-30 12:31:41 | INFO     | src.pipeline.orchestrator:run_pipeline:119 | ================================================================================
2025-09-30 12:31:41 | INFO     | src.pipeline.orchestrator:run_pipeline:120 | STARTING INDUSTRIAL CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:31:41 | INFO     | src.pipeline.orchestrator:run_pipeline:121 | ================================================================================
2025-09-30 12:31:41 | INFO     | src.pipeline.orchestrator:run_pipeline:122 | Start time: 2025-09-30 12:31:41.354138
2025-09-30 12:31:41 | INFO     | src.pipeline.orchestrator:run_pipeline:123 | Environment: development
2025-09-30 12:31:41 | INFO     | src.pipeline.orchestrator:run_pipeline:124 | Configuration loaded from: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/config
2025-09-30 12:31:41 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:31:41 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_COLLECTION
2025-09-30 12:31:41 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:31:41 | INFO     | src.utils.decorators:wrapper:55 | Starting collect_all_data...
2025-09-30 12:31:41 | INFO     | src.data.collector:collect_all_data:48 | Collecting data from sources: ['customers', 'transactions', 'interactions', 'marketing']
2025-09-30 12:31:41 | INFO     | src.data.collector:collect_all_data:49 | Date range: 2023-10-01 to 2025-09-30
2025-09-30 12:31:41 | INFO     | src.utils.database:redis_client:224 | Connected to Redis cache
2025-09-30 12:31:41 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_customers
2025-09-30 12:31:41 | INFO     | src.data.collector:collect_all_data:61 | Loaded customers from cache: 50000 records
2025-09-30 12:31:45 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_transactions
2025-09-30 12:31:45 | INFO     | src.data.collector:collect_all_data:61 | Loaded transactions from cache: 745616 records
2025-09-30 12:31:46 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_interactions
2025-09-30 12:31:46 | INFO     | src.data.collector:collect_all_data:61 | Loaded interactions from cache: 254885 records
2025-09-30 12:31:46 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_marketing
2025-09-30 12:31:46 | INFO     | src.data.collector:collect_all_data:61 | Loaded marketing from cache: 0 records
2025-09-30 12:31:46 | INFO     | src.data.collector:_save_raw_data:500 | Saved customers to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/customers_raw.parquet
2025-09-30 12:31:47 | INFO     | src.data.collector:_save_raw_data:500 | Saved transactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/transactions_raw.parquet
2025-09-30 12:31:47 | INFO     | src.data.collector:_save_raw_data:500 | Saved interactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/interactions_raw.parquet
2025-09-30 12:31:47 | INFO     | src.data.collector:_save_raw_data:500 | Saved marketing to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/marketing_raw.parquet
2025-09-30 12:31:47 | INFO     | src.utils.decorators:wrapper:105 | collect_all_data memory usage: 837.23 MB
2025-09-30 12:31:47 | WARNING  | src.utils.decorators:wrapper:110 | High memory usage detected (837.23 MB). Running garbage collection.
2025-09-30 12:31:47 | SUCCESS  | src.utils.decorators:wrapper:60 | collect_all_data completed in 6.53 seconds
2025-09-30 12:31:47 | INFO     | src.utils.decorators:wrapper:63 | collect_all_data,6.53
2025-09-30 12:31:49 | SUCCESS  | src.pipeline.orchestrator:run_pipeline:172 | ✓ Stage data_collection completed successfully
2025-09-30 12:31:51 | DEBUG    | src.pipeline.orchestrator:_save_checkpoint:567 | Saved checkpoint for stage data_collection
2025-09-30 12:31:51 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:31:51 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_CLEANING
2025-09-30 12:31:51 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:31:51 | INFO     | src.utils.decorators:wrapper:55 | Starting clean_all_data...
2025-09-30 12:31:51 | INFO     | src.data.cleaner:clean_all_data:50 | ==================================================
2025-09-30 12:31:51 | INFO     | src.data.cleaner:clean_all_data:51 | Starting Industial Data Cleaning Pipeline
2025-09-30 12:31:51 | INFO     | src.data.cleaner:clean_all_data:52 | ==================================================
2025-09-30 12:31:51 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning customers dataset...
2025-09-30 12:31:51 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (50000, 12)
2025-09-30 12:31:51 | INFO     | src.data.cleaner:_handle_outliers_iqr:478 | Capped 326 outliers in age
2025-09-30 12:31:51 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (50000, 17)
2025-09-30 12:31:51 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:31:51 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning transactions dataset...
2025-09-30 12:31:51 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (745616, 9)
2025-09-30 12:31:52 | INFO     | src.data.cleaner:_handle_outliers_iqr:478 | Capped 33848 outliers in total_amount
2025-09-30 12:31:52 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (745616, 15)
2025-09-30 12:31:52 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:31:52 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning interactions dataset...
2025-09-30 12:31:52 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (254885, 8)
2025-09-30 12:31:53 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (254885, 10)
2025-09-30 12:31:53 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:31:53 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning marketing dataset...
2025-09-30 12:31:53 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (0, 0)
2025-09-30 12:31:53 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (0, 0)
2025-09-30 12:31:53 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:31:53 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned customers to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/customers_cleaned.parquet
2025-09-30 12:31:53 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned transactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/transactions_cleaned.parquet
2025-09-30 12:31:54 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned interactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/interactions_cleaned.parquet
2025-09-30 12:31:54 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned marketing to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/marketing_cleaned.parquet
2025-09-30 12:31:54 | INFO     | src.data.cleaner:_generate_cleaning_report:522 | Cleaning report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/cleaning_report.txt
2025-09-30 12:31:54 | ERROR    | src.utils.decorators:wrapper:118 | Error in clean_all_data: Object of type int64 is not JSON serializable
2025-09-30 12:31:54 | ERROR    | src.utils.decorators:wrapper:68 | clean_all_data failed after 2.68 seconds: Object of type int64 is not JSON serializable
2025-09-30 12:31:54 | ERROR    | src.pipeline.orchestrator:run_pipeline:178 | ✗ Stage data_cleaning failed: Object of type int64 is not JSON serializable
2025-09-30 12:31:54 | INFO     | src.pipeline.orchestrator:_generate_pipeline_report:608 | Pipeline report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/pipeline_report.json
2025-09-30 12:31:54 | INFO     | src.utils.database:close_connections:279 | All database connections closed
2025-09-30 12:31:54 | DEBUG    | src.pipeline.orchestrator:_cleanup:645 | Resources cleaned up
2025-09-30 12:31:54 | INFO     | src.pipeline.orchestrator:run_pipeline:206 | ================================================================================
2025-09-30 12:31:54 | INFO     | src.pipeline.orchestrator:run_pipeline:207 | PIPELINE EXECUTION COMPLETED
2025-09-30 12:31:54 | INFO     | src.pipeline.orchestrator:run_pipeline:208 | ================================================================================
2025-09-30 12:31:54 | INFO     | src.pipeline.orchestrator:run_pipeline:209 | End time: 2025-09-30 12:31:54.094519
2025-09-30 12:31:54 | INFO     | src.pipeline.orchestrator:run_pipeline:210 | Total execution time: 12.74 seconds
2025-09-30 12:31:54 | INFO     | src.pipeline.orchestrator:run_pipeline:216 | Successful stages: 1
2025-09-30 12:31:54 | INFO     | src.pipeline.orchestrator:run_pipeline:217 | Failed stages: 1
2025-09-30 12:31:54 | INFO     | src.utils.decorators:wrapper:105 | run_pipeline memory usage: 739.09 MB
2025-09-30 12:31:54 | WARNING  | src.utils.decorators:wrapper:110 | High memory usage detected (739.09 MB). Running garbage collection.
2025-09-30 12:31:54 | SUCCESS  | src.utils.decorators:wrapper:60 | run_pipeline completed in 12.87 seconds
2025-09-30 12:31:54 | INFO     | src.utils.decorators:wrapper:63 | run_pipeline,12.87
2025-09-30 12:31:54 | INFO     | __main__:main:147 | 
================================================================================
2025-09-30 12:31:54 | INFO     | __main__:main:148 | PIPELINE EXECUTION SUMMARY
2025-09-30 12:31:54 | INFO     | __main__:main:149 | ================================================================================
2025-09-30 12:31:54 | INFO     | __main__:main:154 | Total Stages: 2
2025-09-30 12:31:54 | INFO     | __main__:main:155 | Successful: 1
2025-09-30 12:31:54 | INFO     | __main__:main:156 | Failed: 1
2025-09-30 12:31:54 | INFO     | __main__:main:161 | ✓ data_collection: 7.66s
2025-09-30 12:31:54 | INFO     | __main__:main:161 | ✗ data_cleaning: 2.68s
2025-09-30 12:31:54 | ERROR    | __main__:main:163 |   Error: Object of type int64 is not JSON serializable
2025-09-30 12:31:54 | INFO     | __main__:main:168 | 
================================================================================
2025-09-30 12:31:54 | ERROR    | __main__:main:180 | PIPELINE FAILED - Please check the logs for details
2025-09-30 12:31:54 | INFO     | __main__:main:182 | ================================================================================
2025-09-30 12:32:53 | INFO     | __main__:main:113 | ================================================================================
2025-09-30 12:32:53 | INFO     | __main__:main:114 | CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:32:53 | INFO     | __main__:main:115 | ================================================================================
2025-09-30 12:32:53 | INFO     | __main__:main:116 | Environment: development
2025-09-30 12:32:53 | INFO     | __main__:main:117 | Python Version: 3.9.6 (default, Nov 11 2024, 03:15:38) 
[Clang 16.0.0 (clang-1600.0.26.6)]
2025-09-30 12:32:53 | INFO     | __main__:main:118 | Project Root: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project
2025-09-30 12:32:53 | INFO     | __main__:main:119 | Start Time: 2025-09-30 12:32:53.014580
2025-09-30 12:32:53 | INFO     | __main__:main:120 | ================================================================================
2025-09-30 12:32:53 | INFO     | src.pipeline.orchestrator:__init__:76 | Pipeline Orchestrator initialized
2025-09-30 12:32:53 | INFO     | src.utils.decorators:wrapper:55 | Starting run_pipeline...
2025-09-30 12:32:53 | INFO     | src.pipeline.orchestrator:run_pipeline:119 | ================================================================================
2025-09-30 12:32:53 | INFO     | src.pipeline.orchestrator:run_pipeline:120 | STARTING INDUSTRIAL CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:32:53 | INFO     | src.pipeline.orchestrator:run_pipeline:121 | ================================================================================
2025-09-30 12:32:53 | INFO     | src.pipeline.orchestrator:run_pipeline:122 | Start time: 2025-09-30 12:32:53.015409
2025-09-30 12:32:53 | INFO     | src.pipeline.orchestrator:run_pipeline:123 | Environment: development
2025-09-30 12:32:53 | INFO     | src.pipeline.orchestrator:run_pipeline:124 | Configuration loaded from: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/config
2025-09-30 12:32:53 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:32:53 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_COLLECTION
2025-09-30 12:32:53 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:32:53 | INFO     | src.utils.decorators:wrapper:55 | Starting collect_all_data...
2025-09-30 12:32:53 | INFO     | src.data.collector:collect_all_data:48 | Collecting data from sources: ['customers', 'transactions', 'interactions', 'marketing']
2025-09-30 12:32:53 | INFO     | src.data.collector:collect_all_data:49 | Date range: 2023-10-01 to 2025-09-30
2025-09-30 12:32:53 | INFO     | src.utils.database:redis_client:224 | Connected to Redis cache
2025-09-30 12:32:53 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_customers
2025-09-30 12:32:53 | INFO     | src.data.collector:collect_all_data:61 | Loaded customers from cache: 50000 records
2025-09-30 12:32:56 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_transactions
2025-09-30 12:32:56 | INFO     | src.data.collector:collect_all_data:61 | Loaded transactions from cache: 745616 records
2025-09-30 12:32:57 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_interactions
2025-09-30 12:32:57 | INFO     | src.data.collector:collect_all_data:61 | Loaded interactions from cache: 254885 records
2025-09-30 12:32:57 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_marketing
2025-09-30 12:32:57 | INFO     | src.data.collector:collect_all_data:61 | Loaded marketing from cache: 0 records
2025-09-30 12:32:57 | INFO     | src.data.collector:_save_raw_data:500 | Saved customers to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/customers_raw.parquet
2025-09-30 12:32:58 | INFO     | src.data.collector:_save_raw_data:500 | Saved transactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/transactions_raw.parquet
2025-09-30 12:32:58 | INFO     | src.data.collector:_save_raw_data:500 | Saved interactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/interactions_raw.parquet
2025-09-30 12:32:58 | INFO     | src.data.collector:_save_raw_data:500 | Saved marketing to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/marketing_raw.parquet
2025-09-30 12:32:58 | INFO     | src.utils.decorators:wrapper:105 | collect_all_data memory usage: 1064.08 MB
2025-09-30 12:32:58 | WARNING  | src.utils.decorators:wrapper:110 | High memory usage detected (1064.08 MB). Running garbage collection.
2025-09-30 12:32:58 | SUCCESS  | src.utils.decorators:wrapper:60 | collect_all_data completed in 5.46 seconds
2025-09-30 12:32:58 | INFO     | src.utils.decorators:wrapper:63 | collect_all_data,5.46
2025-09-30 12:32:59 | SUCCESS  | src.pipeline.orchestrator:run_pipeline:172 | ✓ Stage data_collection completed successfully
2025-09-30 12:33:01 | DEBUG    | src.pipeline.orchestrator:_save_checkpoint:567 | Saved checkpoint for stage data_collection
2025-09-30 12:33:01 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:33:01 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_CLEANING
2025-09-30 12:33:01 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:33:01 | INFO     | src.utils.decorators:wrapper:55 | Starting clean_all_data...
2025-09-30 12:33:01 | INFO     | src.data.cleaner:clean_all_data:50 | ==================================================
2025-09-30 12:33:01 | INFO     | src.data.cleaner:clean_all_data:51 | Starting Industial Data Cleaning Pipeline
2025-09-30 12:33:01 | INFO     | src.data.cleaner:clean_all_data:52 | ==================================================
2025-09-30 12:33:01 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning customers dataset...
2025-09-30 12:33:01 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (50000, 12)
2025-09-30 12:33:02 | INFO     | src.data.cleaner:_handle_outliers_iqr:478 | Capped 326 outliers in age
2025-09-30 12:33:02 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (50000, 17)
2025-09-30 12:33:02 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:33:02 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning transactions dataset...
2025-09-30 12:33:02 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (745616, 9)
2025-09-30 12:33:03 | INFO     | src.data.cleaner:_handle_outliers_iqr:478 | Capped 33848 outliers in total_amount
2025-09-30 12:33:03 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (745616, 15)
2025-09-30 12:33:03 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:33:03 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning interactions dataset...
2025-09-30 12:33:03 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (254885, 8)
2025-09-30 12:33:04 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (254885, 10)
2025-09-30 12:33:04 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:33:04 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning marketing dataset...
2025-09-30 12:33:04 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (0, 0)
2025-09-30 12:33:04 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (0, 0)
2025-09-30 12:33:04 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:33:04 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned customers to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/customers_cleaned.parquet
2025-09-30 12:33:04 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned transactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/transactions_cleaned.parquet
2025-09-30 12:33:04 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned interactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/interactions_cleaned.parquet
2025-09-30 12:33:04 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned marketing to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/marketing_cleaned.parquet
2025-09-30 12:33:04 | INFO     | src.data.cleaner:_generate_cleaning_report:522 | Cleaning report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/cleaning_report.txt
2025-09-30 12:33:04 | INFO     | src.data.cleaner:_generate_cleaning_report:531 | Cleaning JSON report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/cleaning_report.json
2025-09-30 12:33:04 | INFO     | src.utils.decorators:wrapper:105 | clean_all_data memory usage: 182.16 MB
2025-09-30 12:33:04 | SUCCESS  | src.utils.decorators:wrapper:60 | clean_all_data completed in 3.08 seconds
2025-09-30 12:33:04 | INFO     | src.utils.decorators:wrapper:63 | clean_all_data,3.08
2025-09-30 12:33:04 | SUCCESS  | src.pipeline.orchestrator:run_pipeline:172 | ✓ Stage data_cleaning completed successfully
2025-09-30 12:33:07 | DEBUG    | src.pipeline.orchestrator:_save_checkpoint:567 | Saved checkpoint for stage data_cleaning
2025-09-30 12:33:07 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:33:07 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_VALIDATION
2025-09-30 12:33:07 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:33:07 | INFO     | src.data.validator:validate_data:47 | Starting validation for dataset
2025-09-30 12:33:08 | INFO     | src.data.validator:validate_data:69 | Validation complete for dataset: 0 errors, 1 warnings
2025-09-30 12:33:08 | WARNING  | src.data.validator:validate_data:75 | ⚠️  high_cardinality_customer_id: Column 'customer_id' has very high cardinality (50,000 unique values)
2025-09-30 12:33:08 | INFO     | src.data.validator:validate_data:47 | Starting validation for dataset
2025-09-30 12:33:12 | INFO     | src.data.validator:validate_data:69 | Validation complete for dataset: 1 errors, 1 warnings
2025-09-30 12:33:12 | ERROR    | src.data.validator:validate_data:72 | ❌ duplicate_ids_customer_id: Found 695,654 duplicate values in ID column 'customer_id'
2025-09-30 12:33:12 | WARNING  | src.data.validator:validate_data:75 | ⚠️  high_cardinality_transaction_id: Column 'transaction_id' has very high cardinality (745,616 unique values)
2025-09-30 12:33:12 | WARNING  | src.pipeline.orchestrator:_run_data_validation:341 | Dataset transactions failed validation
2025-09-30 12:33:12 | INFO     | src.data.validator:validate_data:47 | Starting validation for dataset
2025-09-30 12:33:13 | INFO     | src.data.validator:validate_data:69 | Validation complete for dataset: 1 errors, 1 warnings
2025-09-30 12:33:13 | ERROR    | src.data.validator:validate_data:72 | ❌ duplicate_ids_customer_id: Found 204,923 duplicate values in ID column 'customer_id'
2025-09-30 12:33:13 | WARNING  | src.data.validator:validate_data:75 | ⚠️  high_cardinality_interaction_id: Column 'interaction_id' has very high cardinality (254,885 unique values)
2025-09-30 12:33:13 | WARNING  | src.pipeline.orchestrator:_run_data_validation:341 | Dataset interactions failed validation
2025-09-30 12:33:13 | INFO     | src.data.validator:validate_data:47 | Starting validation for dataset
2025-09-30 12:33:13 | INFO     | src.data.validator:validate_data:69 | Validation complete for dataset: 1 errors, 1 warnings
2025-09-30 12:33:13 | ERROR    | src.data.validator:validate_data:72 | ❌ empty_dataframe: DataFrame dataset is empty
2025-09-30 12:33:13 | WARNING  | src.data.validator:validate_data:75 | ⚠️  sample_size: Dataset has only 0 records (minimum recommended: 1,000)
2025-09-30 12:33:13 | WARNING  | src.pipeline.orchestrator:_run_data_validation:341 | Dataset marketing failed validation
2025-09-30 12:33:13 | ERROR    | src.pipeline.orchestrator:run_pipeline:178 | ✗ Stage data_validation failed: None
2025-09-30 12:33:13 | INFO     | src.pipeline.orchestrator:_generate_pipeline_report:608 | Pipeline report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/pipeline_report.json
2025-09-30 12:33:13 | ERROR    | src.utils.decorators:wrapper:118 | Error in run_pipeline: Object of type CleaningReport is not JSON serializable
2025-09-30 12:33:13 | ERROR    | src.utils.decorators:wrapper:68 | run_pipeline failed after 20.22 seconds: Object of type CleaningReport is not JSON serializable
2025-09-30 12:33:13 | ERROR    | __main__:main:187 | Pipeline execution failed: Object of type CleaningReport is not JSON serializable
2025-09-30 12:33:13 | ERROR    | __main__:main:188 | Object of type CleaningReport is not JSON serializable
Traceback (most recent call last):

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/scripts/run_pipeline.py", line 193, in <module>
    main()
    └ <function main at 0x163e79ee0>

> File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/scripts/run_pipeline.py", line 140, in main
    results = orchestrator.run_pipeline(
              │            └ <function PipelineOrchestrator.run_pipeline at 0x163e65dc0>
              └ <src.pipeline.orchestrator.PipelineOrchestrator object at 0x163e7ceb0>

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/src/utils/decorators.py", line 58, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {'stages': None, 'resume_from': None, 'use_cache': True, 'continue_on_error': False, 'generate_plots': True, 'deep_clean': Tr...
             │     └ (<src.pipeline.orchestrator.PipelineOrchestrator object at 0x163e7ceb0>,)
             └ <function PipelineOrchestrator.run_pipeline at 0x163e65d30>

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/src/utils/decorators.py", line 99, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {'stages': None, 'resume_from': None, 'use_cache': True, 'continue_on_error': False, 'generate_plots': True, 'deep_clean': Tr...
             │     └ (<src.pipeline.orchestrator.PipelineOrchestrator object at 0x163e7ceb0>,)
             └ <function PipelineOrchestrator.run_pipeline at 0x163e65b80>

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/src/pipeline/orchestrator.py", line 198, in run_pipeline
    self._generate_pipeline_report()
    │    └ <function PipelineOrchestrator._generate_pipeline_report at 0x163e69310>
    └ <src.pipeline.orchestrator.PipelineOrchestrator object at 0x163e7ceb0>

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/src/pipeline/orchestrator.py", line 630, in _generate_pipeline_report
    f.write(f"  Metadata: {json.dumps(result.metadata, indent=4)}\n")
    │ └ <method 'write' of '_io.TextIOWrapper' objects>
    └ <_io.TextIOWrapper name='/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/pipelin...

  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/__init__.py", line 234, in dumps
    return cls(
           └ <class 'json.encoder.JSONEncoder'>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 201, in encode
    chunks = list(chunks)
                  └ <generator object _make_iterencode.<locals>._iterencode at 0x30aff8d60>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
               │                │  └ 0
               │                └ {'cleaning_reports': {'customers': CleaningReport(total_records_before=50000, total_records_after=50000, duplicates_removed=0...
               └ <function _make_iterencode.<locals>._iterencode_dict at 0x30d08f790>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
               └ <generator object _make_iterencode.<locals>._iterencode_dict at 0x30aff8f20>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
               └ <generator object _make_iterencode.<locals>._iterencode at 0x30aff8f90>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 438, in _iterencode
    o = _default(o)
        │        └ CleaningReport(total_records_before=50000, total_records_after=50000, duplicates_removed=0, missing_values_handled={}, outlie...
        └ <bound method JSONEncoder.default of <json.encoder.JSONEncoder object at 0x33aeea370>>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type CleaningReport is not JSON serializable
2025-09-30 12:34:05 | INFO     | __main__:main:113 | ================================================================================
2025-09-30 12:34:05 | INFO     | __main__:main:114 | CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:34:05 | INFO     | __main__:main:115 | ================================================================================
2025-09-30 12:34:05 | INFO     | __main__:main:116 | Environment: development
2025-09-30 12:34:05 | INFO     | __main__:main:117 | Python Version: 3.9.6 (default, Nov 11 2024, 03:15:38) 
[Clang 16.0.0 (clang-1600.0.26.6)]
2025-09-30 12:34:05 | INFO     | __main__:main:118 | Project Root: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project
2025-09-30 12:34:05 | INFO     | __main__:main:119 | Start Time: 2025-09-30 12:34:05.029875
2025-09-30 12:34:05 | INFO     | __main__:main:120 | ================================================================================
2025-09-30 12:34:05 | INFO     | src.pipeline.orchestrator:__init__:76 | Pipeline Orchestrator initialized
2025-09-30 12:34:05 | INFO     | src.utils.decorators:wrapper:55 | Starting run_pipeline...
2025-09-30 12:34:05 | INFO     | src.pipeline.orchestrator:run_pipeline:119 | ================================================================================
2025-09-30 12:34:05 | INFO     | src.pipeline.orchestrator:run_pipeline:120 | STARTING INDUSTRIAL CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:34:05 | INFO     | src.pipeline.orchestrator:run_pipeline:121 | ================================================================================
2025-09-30 12:34:05 | INFO     | src.pipeline.orchestrator:run_pipeline:122 | Start time: 2025-09-30 12:34:05.030616
2025-09-30 12:34:05 | INFO     | src.pipeline.orchestrator:run_pipeline:123 | Environment: development
2025-09-30 12:34:05 | INFO     | src.pipeline.orchestrator:run_pipeline:124 | Configuration loaded from: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/config
2025-09-30 12:34:05 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:34:05 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_COLLECTION
2025-09-30 12:34:05 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:34:05 | INFO     | src.utils.decorators:wrapper:55 | Starting collect_all_data...
2025-09-30 12:34:05 | INFO     | src.data.collector:collect_all_data:48 | Collecting data from sources: ['customers', 'transactions', 'interactions', 'marketing']
2025-09-30 12:34:05 | INFO     | src.data.collector:collect_all_data:49 | Date range: 2023-10-01 to 2025-09-30
2025-09-30 12:34:05 | INFO     | src.utils.database:redis_client:224 | Connected to Redis cache
2025-09-30 12:34:05 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_customers
2025-09-30 12:34:05 | INFO     | src.data.collector:collect_all_data:61 | Loaded customers from cache: 50000 records
2025-09-30 12:34:08 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_transactions
2025-09-30 12:34:08 | INFO     | src.data.collector:collect_all_data:61 | Loaded transactions from cache: 745616 records
2025-09-30 12:34:09 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_interactions
2025-09-30 12:34:09 | INFO     | src.data.collector:collect_all_data:61 | Loaded interactions from cache: 254885 records
2025-09-30 12:34:09 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_marketing
2025-09-30 12:34:09 | INFO     | src.data.collector:collect_all_data:61 | Loaded marketing from cache: 0 records
2025-09-30 12:34:09 | INFO     | src.data.collector:_save_raw_data:500 | Saved customers to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/customers_raw.parquet
2025-09-30 12:34:10 | INFO     | src.data.collector:_save_raw_data:500 | Saved transactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/transactions_raw.parquet
2025-09-30 12:34:11 | INFO     | src.data.collector:_save_raw_data:500 | Saved interactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/interactions_raw.parquet
2025-09-30 12:34:11 | INFO     | src.data.collector:_save_raw_data:500 | Saved marketing to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/marketing_raw.parquet
2025-09-30 12:34:11 | INFO     | src.utils.decorators:wrapper:105 | collect_all_data memory usage: 503.64 MB
2025-09-30 12:34:11 | WARNING  | src.utils.decorators:wrapper:110 | High memory usage detected (503.64 MB). Running garbage collection.
2025-09-30 12:34:11 | SUCCESS  | src.utils.decorators:wrapper:60 | collect_all_data completed in 6.24 seconds
2025-09-30 12:34:11 | INFO     | src.utils.decorators:wrapper:63 | collect_all_data,6.24
2025-09-30 12:34:14 | SUCCESS  | src.pipeline.orchestrator:run_pipeline:172 | ✓ Stage data_collection completed successfully
2025-09-30 12:34:16 | DEBUG    | src.pipeline.orchestrator:_save_checkpoint:567 | Saved checkpoint for stage data_collection
2025-09-30 12:34:16 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:34:16 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_CLEANING
2025-09-30 12:34:16 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:34:16 | INFO     | src.utils.decorators:wrapper:55 | Starting clean_all_data...
2025-09-30 12:34:16 | INFO     | src.data.cleaner:clean_all_data:50 | ==================================================
2025-09-30 12:34:16 | INFO     | src.data.cleaner:clean_all_data:51 | Starting Industial Data Cleaning Pipeline
2025-09-30 12:34:16 | INFO     | src.data.cleaner:clean_all_data:52 | ==================================================
2025-09-30 12:34:16 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning customers dataset...
2025-09-30 12:34:16 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (50000, 12)
2025-09-30 12:34:16 | INFO     | src.data.cleaner:_handle_outliers_iqr:478 | Capped 326 outliers in age
2025-09-30 12:34:16 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (50000, 17)
2025-09-30 12:34:16 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:34:16 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning transactions dataset...
2025-09-30 12:34:16 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (745616, 9)
2025-09-30 12:34:18 | INFO     | src.data.cleaner:_handle_outliers_iqr:478 | Capped 33848 outliers in total_amount
2025-09-30 12:34:18 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (745616, 15)
2025-09-30 12:34:18 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:34:18 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning interactions dataset...
2025-09-30 12:34:18 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (254885, 8)
2025-09-30 12:34:18 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (254885, 10)
2025-09-30 12:34:18 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:34:18 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning marketing dataset...
2025-09-30 12:34:18 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (0, 0)
2025-09-30 12:34:18 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (0, 0)
2025-09-30 12:34:18 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:34:18 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned customers to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/customers_cleaned.parquet
2025-09-30 12:34:19 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned transactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/transactions_cleaned.parquet
2025-09-30 12:34:19 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned interactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/interactions_cleaned.parquet
2025-09-30 12:34:19 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned marketing to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/marketing_cleaned.parquet
2025-09-30 12:34:19 | INFO     | src.data.cleaner:_generate_cleaning_report:522 | Cleaning report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/cleaning_report.txt
2025-09-30 12:34:19 | INFO     | src.data.cleaner:_generate_cleaning_report:531 | Cleaning JSON report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/cleaning_report.json
2025-09-30 12:34:19 | INFO     | src.utils.decorators:wrapper:105 | clean_all_data memory usage: 54.16 MB
2025-09-30 12:34:19 | SUCCESS  | src.utils.decorators:wrapper:60 | clean_all_data completed in 2.99 seconds
2025-09-30 12:34:19 | INFO     | src.utils.decorators:wrapper:63 | clean_all_data,2.99
2025-09-30 12:34:19 | SUCCESS  | src.pipeline.orchestrator:run_pipeline:172 | ✓ Stage data_cleaning completed successfully
2025-09-30 12:34:23 | DEBUG    | src.pipeline.orchestrator:_save_checkpoint:567 | Saved checkpoint for stage data_cleaning
2025-09-30 12:34:23 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:34:23 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_VALIDATION
2025-09-30 12:34:23 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:34:23 | INFO     | src.data.validator:validate_data:47 | Starting validation for dataset
2025-09-30 12:34:23 | INFO     | src.data.validator:validate_data:69 | Validation complete for dataset: 0 errors, 1 warnings
2025-09-30 12:34:23 | WARNING  | src.data.validator:validate_data:75 | ⚠️  high_cardinality_customer_id: Column 'customer_id' has very high cardinality (50,000 unique values)
2025-09-30 12:34:23 | INFO     | src.data.validator:validate_data:47 | Starting validation for dataset
2025-09-30 12:34:27 | INFO     | src.data.validator:validate_data:69 | Validation complete for dataset: 1 errors, 1 warnings
2025-09-30 12:34:27 | ERROR    | src.data.validator:validate_data:72 | ❌ duplicate_ids_customer_id: Found 695,654 duplicate values in ID column 'customer_id'
2025-09-30 12:34:27 | WARNING  | src.data.validator:validate_data:75 | ⚠️  high_cardinality_transaction_id: Column 'transaction_id' has very high cardinality (745,616 unique values)
2025-09-30 12:34:27 | WARNING  | src.pipeline.orchestrator:_run_data_validation:341 | Dataset transactions failed validation
2025-09-30 12:34:27 | INFO     | src.data.validator:validate_data:47 | Starting validation for dataset
2025-09-30 12:34:29 | INFO     | src.data.validator:validate_data:69 | Validation complete for dataset: 1 errors, 1 warnings
2025-09-30 12:34:29 | ERROR    | src.data.validator:validate_data:72 | ❌ duplicate_ids_customer_id: Found 204,923 duplicate values in ID column 'customer_id'
2025-09-30 12:34:29 | WARNING  | src.data.validator:validate_data:75 | ⚠️  high_cardinality_interaction_id: Column 'interaction_id' has very high cardinality (254,885 unique values)
2025-09-30 12:34:29 | WARNING  | src.pipeline.orchestrator:_run_data_validation:341 | Dataset interactions failed validation
2025-09-30 12:34:29 | INFO     | src.data.validator:validate_data:47 | Starting validation for dataset
2025-09-30 12:34:29 | INFO     | src.data.validator:validate_data:69 | Validation complete for dataset: 1 errors, 1 warnings
2025-09-30 12:34:29 | ERROR    | src.data.validator:validate_data:72 | ❌ empty_dataframe: DataFrame dataset is empty
2025-09-30 12:34:29 | WARNING  | src.data.validator:validate_data:75 | ⚠️  sample_size: Dataset has only 0 records (minimum recommended: 1,000)
2025-09-30 12:34:29 | WARNING  | src.pipeline.orchestrator:_run_data_validation:341 | Dataset marketing failed validation
2025-09-30 12:34:29 | ERROR    | src.pipeline.orchestrator:run_pipeline:178 | ✗ Stage data_validation failed: None
2025-09-30 12:34:29 | INFO     | src.pipeline.orchestrator:_generate_pipeline_report:608 | Pipeline report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/pipeline_report.json
2025-09-30 12:34:29 | ERROR    | src.utils.decorators:wrapper:118 | Error in run_pipeline: Object of type CleaningReport is not JSON serializable
2025-09-30 12:34:29 | ERROR    | src.utils.decorators:wrapper:68 | run_pipeline failed after 24.16 seconds: Object of type CleaningReport is not JSON serializable
2025-09-30 12:34:29 | ERROR    | __main__:main:187 | Pipeline execution failed: Object of type CleaningReport is not JSON serializable
2025-09-30 12:34:29 | ERROR    | __main__:main:188 | Object of type CleaningReport is not JSON serializable
Traceback (most recent call last):

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/scripts/run_pipeline.py", line 193, in <module>
    main()
    └ <function main at 0x162977ee0>

> File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/scripts/run_pipeline.py", line 140, in main
    results = orchestrator.run_pipeline(
              │            └ <function PipelineOrchestrator.run_pipeline at 0x162964dc0>
              └ <src.pipeline.orchestrator.PipelineOrchestrator object at 0x16297dfd0>

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/src/utils/decorators.py", line 58, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {'stages': None, 'resume_from': None, 'use_cache': True, 'continue_on_error': False, 'generate_plots': True, 'deep_clean': Tr...
             │     └ (<src.pipeline.orchestrator.PipelineOrchestrator object at 0x16297dfd0>,)
             └ <function PipelineOrchestrator.run_pipeline at 0x162964d30>

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/src/utils/decorators.py", line 99, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {'stages': None, 'resume_from': None, 'use_cache': True, 'continue_on_error': False, 'generate_plots': True, 'deep_clean': Tr...
             │     └ (<src.pipeline.orchestrator.PipelineOrchestrator object at 0x16297dfd0>,)
             └ <function PipelineOrchestrator.run_pipeline at 0x162964b80>

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/src/pipeline/orchestrator.py", line 198, in run_pipeline
    self._generate_pipeline_report()
    │    └ <function PipelineOrchestrator._generate_pipeline_report at 0x16296a310>
    └ <src.pipeline.orchestrator.PipelineOrchestrator object at 0x16297dfd0>

  File "/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/src/pipeline/orchestrator.py", line 630, in _generate_pipeline_report
    f.write(f"  Metadata: {json.dumps(result.metadata, indent=4)}\n")
    │ └ <method 'write' of '_io.TextIOWrapper' objects>
    └ <_io.TextIOWrapper name='/Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/pipelin...

  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/__init__.py", line 234, in dumps
    return cls(
           └ <class 'json.encoder.JSONEncoder'>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 201, in encode
    chunks = list(chunks)
                  └ <generator object _make_iterencode.<locals>._iterencode at 0x333c5add0>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
               │                │  └ 0
               │                └ {'cleaning_reports': {'customers': CleaningReport(total_records_before=50000, total_records_after=50000, duplicates_removed=0...
               └ <function _make_iterencode.<locals>._iterencode_dict at 0x334ab1790>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
               └ <generator object _make_iterencode.<locals>._iterencode_dict at 0x333c5ac80>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
               └ <generator object _make_iterencode.<locals>._iterencode at 0x333c5ae40>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 438, in _iterencode
    o = _default(o)
        │        └ CleaningReport(total_records_before=50000, total_records_after=50000, duplicates_removed=0, missing_values_handled={}, outlie...
        └ <bound method JSONEncoder.default of <json.encoder.JSONEncoder object at 0x33a7bd340>>
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type CleaningReport is not JSON serializable
2025-09-30 12:36:12 | INFO     | __main__:main:113 | ================================================================================
2025-09-30 12:36:12 | INFO     | __main__:main:114 | CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:36:12 | INFO     | __main__:main:115 | ================================================================================
2025-09-30 12:36:12 | INFO     | __main__:main:116 | Environment: development
2025-09-30 12:36:12 | INFO     | __main__:main:117 | Python Version: 3.9.6 (default, Nov 11 2024, 03:15:38) 
[Clang 16.0.0 (clang-1600.0.26.6)]
2025-09-30 12:36:12 | INFO     | __main__:main:118 | Project Root: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project
2025-09-30 12:36:12 | INFO     | __main__:main:119 | Start Time: 2025-09-30 12:36:12.811483
2025-09-30 12:36:12 | INFO     | __main__:main:120 | ================================================================================
2025-09-30 12:36:12 | INFO     | src.pipeline.orchestrator:__init__:76 | Pipeline Orchestrator initialized
2025-09-30 12:36:12 | INFO     | src.utils.decorators:wrapper:55 | Starting run_pipeline...
2025-09-30 12:36:12 | INFO     | src.pipeline.orchestrator:run_pipeline:119 | ================================================================================
2025-09-30 12:36:12 | INFO     | src.pipeline.orchestrator:run_pipeline:120 | STARTING INDUSTRIAL CRM DATA ANALYSIS PIPELINE - PHASE 1
2025-09-30 12:36:12 | INFO     | src.pipeline.orchestrator:run_pipeline:121 | ================================================================================
2025-09-30 12:36:12 | INFO     | src.pipeline.orchestrator:run_pipeline:122 | Start time: 2025-09-30 12:36:12.812976
2025-09-30 12:36:12 | INFO     | src.pipeline.orchestrator:run_pipeline:123 | Environment: development
2025-09-30 12:36:12 | INFO     | src.pipeline.orchestrator:run_pipeline:124 | Configuration loaded from: /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/config
2025-09-30 12:36:12 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:36:12 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_COLLECTION
2025-09-30 12:36:12 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:36:12 | INFO     | src.utils.decorators:wrapper:55 | Starting collect_all_data...
2025-09-30 12:36:12 | INFO     | src.data.collector:collect_all_data:48 | Collecting data from sources: ['customers', 'transactions', 'interactions', 'marketing']
2025-09-30 12:36:12 | INFO     | src.data.collector:collect_all_data:49 | Date range: 2023-10-01 to 2025-09-30
2025-09-30 12:36:12 | INFO     | src.utils.database:redis_client:224 | Connected to Redis cache
2025-09-30 12:36:13 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_customers
2025-09-30 12:36:13 | INFO     | src.data.collector:collect_all_data:61 | Loaded customers from cache: 50000 records
2025-09-30 12:36:17 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_transactions
2025-09-30 12:36:17 | INFO     | src.data.collector:collect_all_data:61 | Loaded transactions from cache: 745616 records
2025-09-30 12:36:19 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_interactions
2025-09-30 12:36:19 | INFO     | src.data.collector:collect_all_data:61 | Loaded interactions from cache: 254885 records
2025-09-30 12:36:19 | INFO     | src.utils.database:get_cached_dataframe:257 | Retrieved cached DataFrame with key: raw_marketing
2025-09-30 12:36:19 | INFO     | src.data.collector:collect_all_data:61 | Loaded marketing from cache: 0 records
2025-09-30 12:36:19 | INFO     | src.data.collector:_save_raw_data:500 | Saved customers to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/customers_raw.parquet
2025-09-30 12:36:19 | INFO     | src.data.collector:_save_raw_data:500 | Saved transactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/transactions_raw.parquet
2025-09-30 12:36:20 | INFO     | src.data.collector:_save_raw_data:500 | Saved interactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/interactions_raw.parquet
2025-09-30 12:36:20 | INFO     | src.data.collector:_save_raw_data:500 | Saved marketing to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/raw/marketing_raw.parquet
2025-09-30 12:36:20 | INFO     | src.utils.decorators:wrapper:105 | collect_all_data memory usage: 701.66 MB
2025-09-30 12:36:20 | WARNING  | src.utils.decorators:wrapper:110 | High memory usage detected (701.66 MB). Running garbage collection.
2025-09-30 12:36:20 | SUCCESS  | src.utils.decorators:wrapper:60 | collect_all_data completed in 7.53 seconds
2025-09-30 12:36:20 | INFO     | src.utils.decorators:wrapper:63 | collect_all_data,7.53
2025-09-30 12:36:21 | SUCCESS  | src.pipeline.orchestrator:run_pipeline:172 | ✓ Stage data_collection completed successfully
2025-09-30 12:36:25 | DEBUG    | src.pipeline.orchestrator:_save_checkpoint:567 | Saved checkpoint for stage data_collection
2025-09-30 12:36:25 | INFO     | src.pipeline.orchestrator:run_pipeline:146 | 
==================================================
2025-09-30 12:36:25 | INFO     | src.pipeline.orchestrator:run_pipeline:147 | EXECUTING STAGE: DATA_CLEANING
2025-09-30 12:36:25 | INFO     | src.pipeline.orchestrator:run_pipeline:148 | ==================================================
2025-09-30 12:36:25 | INFO     | src.utils.decorators:wrapper:55 | Starting clean_all_data...
2025-09-30 12:36:25 | INFO     | src.data.cleaner:clean_all_data:50 | ==================================================
2025-09-30 12:36:25 | INFO     | src.data.cleaner:clean_all_data:51 | Starting Industial Data Cleaning Pipeline
2025-09-30 12:36:25 | INFO     | src.data.cleaner:clean_all_data:52 | ==================================================
2025-09-30 12:36:25 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning customers dataset...
2025-09-30 12:36:25 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (50000, 12)
2025-09-30 12:36:25 | INFO     | src.data.cleaner:_handle_outliers_iqr:478 | Capped 326 outliers in age
2025-09-30 12:36:25 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (50000, 17)
2025-09-30 12:36:25 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:36:25 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning transactions dataset...
2025-09-30 12:36:25 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (745616, 9)
2025-09-30 12:36:26 | INFO     | src.data.cleaner:_handle_outliers_iqr:478 | Capped 33848 outliers in total_amount
2025-09-30 12:36:27 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (745616, 15)
2025-09-30 12:36:27 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:36:27 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning interactions dataset...
2025-09-30 12:36:27 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (254885, 8)
2025-09-30 12:36:27 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (254885, 10)
2025-09-30 12:36:27 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:36:27 | INFO     | src.data.cleaner:clean_all_data:57 | 
Cleaning marketing dataset...
2025-09-30 12:36:27 | INFO     | src.data.cleaner:clean_all_data:58 | Initial shape: (0, 0)
2025-09-30 12:36:27 | INFO     | src.data.cleaner:clean_all_data:88 | Cleaned shape: (0, 0)
2025-09-30 12:36:27 | INFO     | src.data.cleaner:clean_all_data:89 | Records removed: 0
2025-09-30 12:36:27 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned customers to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/customers_cleaned.parquet
2025-09-30 12:36:29 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned transactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/transactions_cleaned.parquet
2025-09-30 12:36:30 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned interactions to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/interactions_cleaned.parquet
2025-09-30 12:36:30 | INFO     | src.data.cleaner:_save_cleaned_data:487 | Saved cleaned marketing to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/data/interim/marketing_cleaned.parquet
2025-09-30 12:36:30 | INFO     | src.data.cleaner:_generate_cleaning_report:522 | Cleaning report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/cleaning_report.txt
2025-09-30 12:36:30 | INFO     | src.data.cleaner:_generate_cleaning_report:531 | Cleaning JSON report saved to /Users/lenguyen/Documents/research-projects/01-data-science/001-CRM-analysis-project/reports/cleaning_report.json
2025-09-30 12:36:30 | INFO     | src.utils.decorators:wrapper:105 | clean_all_data memory usage: -273.30 MB
2025-09-30 12:36:30 | SUCCESS  | src.utils.decorators:wrapper:60 | clean_all_data completed in 4.96 seconds
2025-09-30 12:36:30 | INFO     | src.utils.decorators:wrapper:63 | clean_all_data,4.96
2025-09-30 12:36:30 | SUCCESS  | src.pipeline.orchestrator:run_pipeline:172 | ✓ Stage data_cleaning completed successfully
